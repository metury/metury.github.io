<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Year 2024 day 6 - Personal page</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Personal page</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="advent-of-code---year-2024-day-6"><a class="header" href="#advent-of-code---year-2024-day-6">Advent of code - Year 2024 Day 6</a></h1>
<p>This is a solution of the <a href="https://adventofcode.com/2024/day/6">day 6</a>. Go back to year <a href="2024.html">2024</a>. Go back to <a href="../adventofcode.html">AOC</a>.</p>
<h3 id="information"><a class="header" href="#information">Information</a></h3>
<h4 id="part-1"><a class="header" href="#part-1">Part 1</a></h4>
<p>In the first part we only simulate the steps of the guard and mark visited places on the map. Afterward we count the number of such visited places.</p>
<h4 id="part-2"><a class="header" href="#part-2">Part 2</a></h4>
<p>In the second part we also compute the visited places as in previous step to see candidates for obstacles. Because we may easily see that putting an obstacle outside the path is worthless. Then we put the obstacle into the map and test if we find loop or not. If so count such instance and move on. <em>Note that this is not close to optimal solution, since we are computing the prefix of the path over and over again. It would be good idea to remember previous path to not compute it again.</em> <strong>On the other hand given solution terminates with the result after a few seconds (approximately 3s), therefore it is not worth the time to optimize the code.</strong></p>
<h2 id="maingo"><a class="header" href="#maingo">main.go</a></h2>
<pre><code class="language-go">package main

import (
  "fmt"
  "log"
  "os"
  "strings"
  "time"
)

type Map [][]bool
type Position [2]int

func read_file(file_path string) (Map, Position) {
  content, err := os.ReadFile(file_path)
  if err != nil {
    log.Fatal(err)
  }
  lines := strings.Split(string(content), "\n")
  var m (Map)
  var pos Position
  for i, line := range lines {
    if len(line) &lt;= 0 {
      continue
    }
    row := make([]bool, len(line))
    for j, char := range strings.Split(line, "") {
      switch char {
      case ".":
        row[j] = true
      case "#":
        row[j] = false
      case "^":
        pos = [2]int{i, j}
        row[j] = true
      }
    }
    m = append(m, row)
  }
  return m, pos
}

func guard_step(m Map, pos Position, step Position) (Position, Position, bool) {
  new_pos := [2]int{pos[0] + step[0], pos[1] + step[1]}
  inside := new_pos[0] &lt; len(m) &amp;&amp; new_pos[0] &gt;= 0 &amp;&amp; new_pos[1] &lt; len(m[0]) &amp;&amp; new_pos[1] &gt;= 0
  if inside &amp;&amp; m[new_pos[0]][new_pos[1]] {
    return new_pos, step, inside
  } else if inside {
    step[0], step[1] = step[1], -step[0]
    inside := pos[0] &lt; len(m) &amp;&amp; pos[0] &gt;= 0 &amp;&amp; pos[1] &lt; len(m[0]) &amp;&amp; pos[1] &gt;= 0
    return pos, step, inside
  } else {
    return new_pos, step, false
  }
}

func found_visited(m Map, pos Position) Map {
  visited := make(Map, len(m))
  for i := range visited {
    visited[i] = make([]bool, len(m[i]))
  }
  visited[pos[0]][pos[1]] = true
  step := [2]int{-1, 0}
  pos, step, ok := guard_step(m, pos, step)
  for ok {
    visited[pos[0]][pos[1]] = true
    pos, step, ok = guard_step(m, pos, step)
  }
  return visited
}

func is_loop(m Map, pos Position) bool {
  visited := make(map[[4]int]bool)
  step := [2]int{-1, 0}
  visited[[4]int{pos[0], pos[1], step[0], step[1]}] = true
  pos, step, ok := guard_step(m, pos, step)
  _, hash_ok := visited[[4]int{pos[0], pos[1], step[0], step[1]}]
  for ok &amp;&amp; !hash_ok {
    _, hash_ok = visited[[4]int{pos[0], pos[1], step[0], step[1]}]
    visited[[4]int{pos[0], pos[1], step[0], step[1]}] = true
    pos, step, ok = guard_step(m, pos, step)
  }
  return hash_ok
}

func part1() {
  var result int
  start := time.Now()
  m, pos := read_file("INPUT")
  visited := found_visited(m, pos)
  for i := range visited {
    for j := range visited[i] {
      if visited[i][j] {
        result += 1
      }
    }
  }
  end := time.Now()
  fmt.Println("Part 1 [", end.Sub(start), "]:", result)
}

func part2() {
  var result int
  start := time.Now()
  m, pos := read_file("INPUT")
  visited_map := found_visited(m, pos)
  var visited_pos [][2]int
  for i := range visited_map {
    for j := range visited_map[i] {
      if visited_map[i][j] {
        visited_pos = append(visited_pos, [2]int{i, j})
      }
    }
  }
  for _, obstacle := range visited_pos {
    m[obstacle[0]][obstacle[1]] = false
    if is_loop(m, pos) {
      result += 1
    }
    m[obstacle[0]][obstacle[1]] = true
  }

  end := time.Now()
  fmt.Println("Part 2 [", end.Sub(start), "]:", result)
}

func main() {
  fmt.Println("Year 2024 day 6 - Guard Gallivant")
  part1()
  part2()
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../aoc/2024-5.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../aoc/2023.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../aoc/2024-5.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../aoc/2023.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
